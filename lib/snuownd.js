/**
 @preserve snuownd.js - javascript port of reddit's "snudown" markdown parser
 https://github.com/gamefreak/snuownd
 */
/**
 * @license Copyright (c) 2009, Natacha PortÃ©
 * Copyright (c) 2011, Vicent Marti
 * Copyright (c) 2012, Scott McClaugherty
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
 * WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
 * MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
 * ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
 * WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
 * ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
 * OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
 */
// up to date with commit b6baacb79996cec794a20d3abcae51adec5cc3cd

(function(e){function t(e){return e==" "||e=="\n"}function n(e){return/[\x09-\x0d ]/.test(e)}function r(e){return/[A-Za-z0-9]/.test(e)}function i(e){return/[A-Za-z]/.test(e)}function s(e){return/[\x20-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]/.test(e)}function o(e){var t="0123456789ABCDEF";return"%"+t[(e&240)>>4]+t[(e&15)>>0]}function u(e){var t=e.charCodeAt(0);if(t<128){return o(t)}else if(t>127&&t<2048){var n=o(t>>6&255|192);n+=o(t>>0&63|128);return n}else{var n=o(t>>12&255|224);n+=o(t>>6&63|128);n+=o(t>>0&63|128);return n}}function a(e){var t=["p","dl","div","math","table","ul","del","form","blockquote","figure","ol","fieldset","h1","h6","pre","script","h5","noscript","style","iframe","h4","ins","h3","h2"];if(t.indexOf(e.toLowerCase())!=-1){return e.toLowerCase()}return""}function f(e,t){var r;var i=0;var s=e.length;if(s<3||e[0]!="<")return hn;r=1;if(e[r]=="/"){i=1;r++}var o=0;for(;r<s;++r,++o){if(o>=t.length)break;if(e[r]!=t[o])return hn}if(r==s)return hn;if(n(e[r])||e[r]==">")return i?dn:pn;return hn}function l(e,t){var n=0,r;while(n<t.s.length){r=n;while(n<t.s.length&&t.s[n]!="\\")n++;if(n>r)e.s+=t.s.slice(r,n);if(n+1>=t.s.length)break;e.s+=t.s[n+1];n+=2}}function p(e,t,n){var r=0,i,s=0;while(r<t.length){i=r;while(r<t.length&&!(s=c[t.charCodeAt(r)]))r++;if(r>i)e.s+=t.slice(i,r);if(r>=t.length)break;if(t[r]=="/"&&!n){e.s+="/"}else if(c[t.charCodeAt(r)]==7){}else{e.s+=h[s]}r++}}function v(e,t){var n=0,r;while(n<t.length){r=n;while(n<t.length&&d[t.charCodeAt(n)]!=0)n++;if(n>r)e.s+=t.slice(r,n);if(n>=t.length)break;if(d[t.charCodeAt(n)]==2){n++;continue}switch(t[n]){case"&":e.s+="&";break;case"'":e.s+="&#x27;";break;default:e.s+=u(t[n])}n++}}function m(e,t){var n,r=0;var s;for(s=0;s<t;++s)if(e[s]=="<"){t=s;break}while(t>0){if("?!.,".indexOf(e[t-1])!=-1)t--;else if(e[t-1]==";"){var o=t-2;while(o>0&&i(e[o]))o--;if(o<t-2&&e[o]=="&")t=o;else t--}else break}if(t==0)return 0;n=e[t-1];switch(n){case'"':r='"';break;case"'":r="'";break;case")":r="(";break;case"]":r="[";break;case"}":r="{";break}if(r!=0){var u=0;var a=0;var f=0;while(f<t){if(e[f]==r)a++;else if(e[f]==n)u++;f++}if(u!=a)t--}return t}function g(e,t){var n,i=0;if(!r(e[0]))return 0;for(n=1;n<e.length-1;++n){if(e[n]==".")i++;else if(!r(e[n])&&e[n]!="-")break}if(t){return n}else{return i?n:0}}function y(e){var t=["http://","https://","ftp://","mailto://","/","git://","steam://","irc://","news://","mumble://","ssh://","ircs://","#"];var n;for(n=0;n<t.length;++n){var r=t[n].length;if(e.length>r&&e.toLowerCase().indexOf(t[n])==0&&/[A-Za-z0-9#\/?]/.test(e[r]))return 1}return 0}function b(e,t,r,s,o,u){var a=r.slice(s);var f,l=0,c;if(o<4||r[s+1]!="/"||r[s+2]!="/")return 0;while(l<s&&i(r[s-l-1]))l++;if(!y(r.substr(s-l,o+l)))return 0;f="://".length;c=g(a.slice(f),u&jt);if(c==0)return 0;f+=c;while(f<o&&!n(r[s+f]))f++;f=m(a,f);if(f==0)return 0;t.s+=r.substr(s-l,f+l);e.p=l;return f}function w(e,t,n,i,s){var o=n.slice(i);var u;var a=false;if(s<3)return 0;if(o.indexOf("/r/")!=0)return 0;u="/r/".length;if(o.substr(u-1,4).toLowerCase()=="all-"){a=true}do{var f=u;var l=24;if(s>=u+10&&o.substr(u,10).toLowerCase()=="reddit.com"){u+=10;l=10}else{if(s>u+2&&o.substr(u,2)=="t:")u+=2;if(!r(o[u]))return 0;u+=1}while(u<s&&(r(o[u])||o[u]=="_"))u++;if(u-f<2||u-f>l)return 0}while(u<s&&(o[u]=="+"||a&&o[u]=="-")&&u++);if(u<s&&o[u]=="/"){while(u<s&&(r(o[u])||o[u]=="_"||o[u]=="/"||o[u]=="-")){u++}}t.s+=o.slice(0,u);e.p=0;return u}function E(e,t,n,i,s){var o=n.slice(i);var u;if(s<6)return 0;if(o.indexOf("/u/")!=0)return 0;u="/u/".length;if(!r(o[u])&&o[u]!="_"&&o[u]!="-")return 0;u+=1;while(u<s&&(r(o[u])||o[u]=="_"||o[u]=="/"||o[u]=="-"))u++;t.s+=o.slice(0,u);e.p=0;return u}function S(e,t,n,i,s,o){var u=n.slice(i);var a,f;var l=0,c=0;for(f=0;f<i;++f){var h=n[i-f-1];if(r(h))continue;if(".+-_".indexOf(h)!=-1)continue;break}if(f==0)return 0;for(a=0;a<s;++a){var h=n[i+a];if(r(h))continue;if(h=="@")l++;else if(h=="."&&a<s-1)c++;else if(h!="-"&&h!="_")break}if(a<2||l!=1||c==0)return 0;a=m(u,a);if(a==0)return 0;t.s+=n.substr(i-f,a+f);e.p=f;return a}function x(e,t,r,i,o,u){var a=r.slice(i);var f;if(i>0&&!s(r[i-1])&&!n(r[i-1]))return 0;if(o<4||a.slice(0,4)!="www.")return 0;f=g(a,0);if(f==0)return 0;while(f<o&&!n(a[f]))f++;f=m(a,f);if(f==0)return 0;t.s+=a.slice(0,f);e.p=0;return f}function T(e){if(e){for(var t in e){if(t in this)this[t]=e[t]}}}function N(e,t){this.callbacks=e;this.context=t}function C(e,t){return new N(e,t)}function k(){return{nofollow:0,target:null,tocData:{headerCount:0,currentLevel:0,levelOffset:0},toc_id_prefix:null,html_element_whitelist:er,html_attr_whitelist:Zn,flags:0,link_attributes:function(t,n,r){if(r.nofollow)t.s+=' rel="nofollow"';if(r.target!=null){t.s+=' target="'+r.target+'"'}}}}function L(e){var t=k();if(e==null){t.flags=Gn}else{t.flags=e}var n=new N(M(),t);if(n.context.flags&Gt)n.callbacks.image=null;if(n.context.flags&Yt){n.callbacks.link=null;n.callbacks.autolink=null}if(n.context.flags&Kt||n.context.flags&sn)n.callbacks.blockhtml=null;return n}function A(){var e=k();e.flags=tn|Kt;var t=new N(_(),e);return t}function O(e){return new T(e)}function M(){return new T({blockcode:D,blockquote:P,blockhtml:H,header:B,hrule:j,list:F,listitem:I,paragraph:q,table:R,table_row:U,table_cell:z,autolink:W,codespan:X,double_emphasis:V,emphasis:$,image:J,linebreak:K,link:Q,raw_html_tag:Y,triple_emphasis:Z,strikethrough:et,superscript:tt,entity:null,normal_text:nt,doc_header:null,doc_footer:st})}function _(){return new T({blockcode:null,blockquote:null,blockhtml:null,header:rt,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:X,double_emphasis:V,emphasis:$,image:null,linebreak:null,link:it,raw_html_tag:null,triple_emphasis:Z,strikethrough:et,superscript:tt,entity:null,normal_text:null,doc_header:null,doc_footer:ot})}function D(e,t,r,i){if(e.s.length)e.s+="\n";if(r&&r.s.length){var s,o;e.s+='<pre><code class="';for(s=0,o=0;s<r.s.length;++s,++o){while(s<r.s.length&&n(r.s[s]))s++;if(s<r.s.length){var u=s;while(s<r.s.length&&!n(r.s[s]))s++;if(r.s[u]==".")u++;if(o)e.s+=" ";p(e,r.s.slice(u,s),false)}}e.s+='">'}else e.s+="<pre><code>";if(t)p(e,t.s,false);e.s+="</code></pre>\n"}function P(e,t,n){if(e.s.length)e.s+="\n";e.s+="<blockquote>\n";if(t)e.s+=t.s;e.s+="</blockquote>\n"}function H(e,t,n){var r,i;if(!t)return;i=t.s.length;while(i>0&&t.s[i-1]=="\n")i--;r=0;while(r<i&&t.s[r]=="\n")r++;if(r>=i)return;if(e.s.length)e.s+="\n";e.s+=t.s.slice(r,i);e.s+="\n"}function B(e,t,n,r){if(e.s.length)e.s+="\n";if(r.flags&tn){e.s+="<h"+ +n+' id="';if(r.toc_id_prefix)e.s+=r.toc_id_prefix;e.s+="toc_"+r.tocData.headerCount++ +'">'}else{e.s+="<h"+ +n+">"}if(t)e.s+=t.s;e.s+="</h"+ +n+">\n"}function j(e,t){if(e.s.length)e.s+="\n";e.s+=t.flags&rn?"<hr/>\n":"<hr>\n"}function F(e,t,n,r){if(e.s.length)e.s+="\n";e.s+=n&wt?"<ol>\n":"<ul>\n";if(t)e.s+=t.s;e.s+=n&wt?"</ol>\n":"</ul>\n"}function I(e,t,n,r){e.s+="<li>";if(t){var i=t.s.length;while(i&&t.s[i-1]=="\n")i--;e.s+=t.s.slice(0,i)}e.s+="</li>\n"}function q(e,t,r){var i=0;if(e.s.length)e.s+="\n";if(!t||!t.s.length)return;while(i<t.s.length&&n(t.s[i]))i++;if(i==t.s.length)return;e.s+="<p>";if(r.flags&nn){var s;while(i<t.s.length){s=i;while(i<t.s.length&&t.data[i]!="\n")i++;if(i>s)e.s+=t.s.slice(s,i);if(i>=t.s.length-1)break;K(e,r);i++}}else{e.s+=t.s.slice(i)}e.s+="</p>\n"}function R(e,t,n,r){if(e.s.length)e.s+="\n";e.s+="<table><thead>\n";if(t)e.s+=t.s;e.s+="</thead><tbody>\n";if(n)e.s+=n.s;e.s+="</tbody></table>\n"}function U(e,t,n){e.s+="<tr>\n";if(t)e.s+=t.s;e.s+="</tr>\n"}function z(e,t,n,r){if(n&cn){e.s+="<th"}else{e.s+="<td"}switch(n&ln){case fn:e.s+=' align="center">';break;case un:e.s+=' align="left">';break;case an:e.s+=' align="right">';break;default:e.s+=">"}if(t)e.s+=t.s;if(n&cn){e.s+="</th>\n"}else{e.s+="</td>\n"}}function W(e,t,n,r){var i=0;if(!t||!t.s.length)return 0;if((r.flags&en)!=0&&!y(t.s)&&n!=qt)return 0;e.s+='<a href="';if(n==qt)e.s+="mailto:";v(e,t.s.slice(i));if(r.link_attributes){e.s+='"';r.link_attributes(e,t,r);e.s+=">"}else{e.s+='">'}if(t.s.indexOf("mailto:")==0){p(e,t.s.slice(7),false)}else{p(e,t.s,false)}e.s+="</a>";return 1}function X(e,t,n){e.s+="<code>";if(t)p(e,t.s,false);e.s+="</code>";return 1}function V(e,t,n){if(!t||!t.s.length)return 0;e.s+="<strong>"+t.s+"</strong>";return 1}function $(e,t,n){if(!t||!t.s.length)return 0;e.s+="<em>"+t.s+"</em>";return 1}function J(e,t,n,r,i){if(!t||!t.s.length)return 0;e.s+='<img src="';v(e,t.s);e.s+='" alt="';if(r&&r.s.length)p(e,r.s,false);if(n&&n.s.length){e.s+='" title="';p(e,n.s,false)}e.s+=i.flags&rn?'"/>':'">';return 1}function K(e,t){e.s+=t.flags&rn?"<br/>\n":"<br>\n";return 1}function Q(e,t,n,r,i){if(t!=null&&(i.flags&en)!=0&&!y(t.s))return 0;e.s+='<a href="';if(t&&t.s.length)v(e,t.s);if(n&&n.s.length){e.s+='" title="';p(e,n.s,false)}if(i.link_attributes){e.s+='"';i.link_attributes(e,t,i);e.s+=">"}else{e.s+='">'}if(r&&r.s.length)e.s+=r.s;e.s+="</a>";return 1}function G(e,t,n,r,i,s){var o,u,a=0,f=0,l,c;var h=new vn;var p;e.s+="<";var d=1+r.length;if(s==dn){e.s+="/";d+=1}e.s+=r;if(s!=dn){for(;d<t.s.length;d++){p=t.s[d];l=0;c=0;switch(p){case">":if(f&&!a){l=1;c=1}else{c=1}break;case"'":case'"':if(!a)a=p;else if(a==p)a=!a;break;default:if(!a){switch(p){case" ":if(f){l=1;c=1}else c=1;break;case"=":if(f){c=1}else{for(u=0;u<i.length;u++){if(i[u].length!=h.s.length)continue;for(o=0;o<h.s.length;o++){if(i[u][o].toLowerCase()!=h.s[o].toLowerCase())break}if(o==h.s.length)f=1}if(!f)c=1}break}}}if(l){e.s+=" "+h.s}if(c){f=0;a=0;h.s=""}else{h.s+=p}}}e.s+=">"}function Y(e,t,n){var r=n.html_element_whitelist;if((n.flags&on)!=0&&r){for(var i=0;r[i];i++){var s=f(t.s,r[i]);if(s!=hn){G(e,t,n,r[i],n.html_attr_whitelist,s);return 1}}}if((n.flags&sn)!=0){p(e,t.s,false);return 1}if((n.flags&Kt)!=0)return 1;if((n.flags&Qt)!=0&&f(t.s,"style"))return 1;if((n.flags&Yt)!=0&&f(t.s,"a"))return 1;if((n.flags&Gt)!=0&&f(t.s,"img"))return 1;e.s+=t.s;return 1}function Z(e,t,n){if(!t||!t.s.length)return 0;e.s+="<strong><em>"+t.s+"</em></strong>";return 1}function et(e,t,n){if(!t||!t.s.length)return 0;e.s+="<del>"+t.s+"</del>";return 1}function tt(e,t,n){if(!t||!t.s.length)return 0;e.s+="<sup>"+t.s+"</sup>";return 1}function nt(e,t,n){if(t)p(e,t.s,false)}function rt(e,t,n,r){if(r.tocData.currentLevel==0){e.s+='<div class="toc">\n';r.tocData.levelOffset=n-1}n-=r.tocData.levelOffset;if(n>r.tocData.currentLevel){while(n>r.tocData.currentLevel){e.s+="<ul>\n<li>\n";r.tocData.currentLevel++}}else if(n<r.tocData.currentLevel){e.s+="</li>\n";while(n<r.tocData.currentLevel){e.s+="</ul>\n</li>\n";r.tocData.currentLevel--}e.s+="<li>\n"}else{e.s+="</li>\n<li>\n"}e.s+='<a href="#';if(r.toc_id_prefix)e.s+=r.toc_id_prefix;e.s+="toc_"+r.tocData.headerCount++ +'">';if(t)p(e,t.s,false);e.s+="</a>\n"}function it(e,t,n,r,i){if(r&&r.s)e.s+=r.s;return 1}function st(e,t){t.tocData={headerCount:0,currentLevel:0,levelOffset:0}}function ot(e,t){var n=false;while(t.tocData.currentLevel>0){e.s+="</li>\n</ul>\n";t.tocData.currentLevel--;n=true}if(n){e.s+="</div>\n"}st(e,t)}function ut(e,n,r,i){var s=r.slice(i);var o=s.length;var u=s[0];var a;if(o>2&&s[1]!=u){if(u=="~"||t(s[1])||(a=Sn(e,n,s,u))==0)return 0;return a+1}if(s.length>3&&s[1]==u&&s[2]!=u){if(t(s[2])||(a=xn(e,n,s,u))==0)return 0;return a+2}if(s.length>4&&s[1]==u&&s[2]==u&&s[3]!=u){if(u=="~"||t(s[3])||(a=Tn(e,n,s,u))==0)return 0;return a+3}return 0}function at(e,t,n,r){var i=n.slice(r);var s,o=0,u,a,f;while(o<i.length&&i[o]=="`")o++;u=0;for(s=o;s<i.length&&u<o;s++){if(i[s]=="`")u++;else u=0}if(u<o&&s>=i.length)return 0;a=o;while(a<s&&i[a]==" ")a++;f=s-o;while(f>o&&i[f-1]==" ")f--;if(a<f){var l=new vn(i.slice(a,f));if(!t.callbacks.codespan(e,l,t.context))s=0}else{if(!t.callbacks.codespan(e,null,t.context))s=0}return s}function ft(e,t,n,r){var i=n.slice(r);if(r<2||n[r-1]!=" "||n[r-2]!=" ")return 0;var s=e.s.length;while(s&&e.s[s-1]==" ")s--;e.s=e.s.slice(0,s);return t.callbacks.linebreak(e,t.context)?1:0}function lt(e,n,r,i){function T(){n.spanStack.length=b;return E?a:0}var s=r.slice(i);var o=i&&r[i-1]=="!",u;var a=1,f,c=0,h=0,p=0,d=0;var v=null;var m=null;var g=null;var y=null;var b=n.spanStack.length;var w=0,E=0;var S=0,x=0;if(o&&!n.callbacks.image||!o&&!n.callbacks.link)return T();for(u=1;a<s.length;a++){if(s[a]=="\n")w=1;else if(s[a-1]=="\\")continue;else if(s[a]=="[")u++;else if(s[a]=="]"){u--;if(u<=0)break}}if(a>=s.length)return T();f=a;a++;while(a<s.length&&t(s[a]))a++;if(a<s.length&&s[a]=="("){a++;while(a<s.length&&t(s[a]))a++;c=a;while(a<s.length){if(s[a]=="\\")a+=2;else if(s[a]==")")break;else if(a>=1&&t(s[a-1])&&(s[a]=="'"||s[a]=='"'))break;else a++}if(a>=s.length)return T();h=a;if(s[a]=="'"||s[a]=='"'){x=s[a];S=1;a++;p=a;while(a<s.length){if(s[a]=="\\")a+=2;else if(s[a]==x){S=0;a++}else if(s[a]==")"&&!S)break;else a++}if(a>=s.length)return T();d=a-1;while(d>p&&t(s[d]))d--;if(s[d]!="'"&&s[d]!='"'){p=d=0;h=a}}while(h>c&&t(s[h-1]))h--;if(s[c]=="<")c++;if(s[h-1]==">")h--;if(h>c){m=new vn;n.spanStack.push(m);m.s+=s.slice(c,h)}if(d>p){g=new vn;n.spanStack.push(g);g.s+=s.slice(p,d)}a++}else if(a<s.length&&s[a]=="["){var N=new vn;var C=null;a++;c=a;while(a<s.length&&s[a]!="]")a++;if(a>=s.length)return T();h=a;if(c==h){if(w){var k=new vn;n.spanStack.push(k);var L;for(L=1;L<f;L++){if(s[L]!="\n")k.s+=s[L];else if(s[L-1]!=" ")k.s+=" "}N.s=k.s}else{N.s=s.slice(1)}}else{N.s=s.slice(c,h)}C=n.refs[N.s];if(!C)return T();m=C.link;g=C.title;a++}else{var N=new vn;var C=null;if(w){var k=new vn;n.spanStack.push(k);var L;for(L=1;L<f;L++){if(s[L]!="\n")k.s+=s[L];else if(s[L-1]!=" ")k.s+=" "}N.s=k.s}else{N.s=s.slice(1,f)}C=n.refs[N.s];if(!C)return T();m=C.link;g=C.title;a=f+1}if(f>1){v=new vn;n.spanStack.push(v);if(o){v.s+=s.slice(1,f)}else{n.inLinkBody=1;Pn(v,n,s.slice(1,f));n.inLinkBody=0}}if(m){y=new vn;n.spanStack.push(y);l(y,m)}else{return T()}if(o){if(e.s.length&&e.s[e.s.length-1]=="!")e.s=e.s.slice(0,-1);E=n.callbacks.image(e,y,g,v,n.context)}else{E=n.callbacks.link(e,y,g,v,n.context)}return T()}function ct(e,t,n,r){var i=n.slice(r);var s={p:Ft};var o=Dn(i,s);var u=new vn(i.slice(0,o));var a=0;if(o>2){if(t.callbacks.autolink&&s.p!=Ft){var f=new vn;t.spanStack.push(f);u.s=i.substr(1,o-2);l(f,u);a=t.callbacks.autolink(e,f,s.p,t.context);t.spanStack.pop()}else if(t.callbacks.raw_html_tag)a=t.callbacks.raw_html_tag(e,u,t.context)}if(!a)return 0;else return o}function ht(e,t,n,r){var i=n.slice(r);var s="\\`*_{}[]()#+-.!:|&<>/^~";var o=new vn;if(i.length>1){if(s.indexOf(i[1])==-1)return 0;if(t.callbacks.normal_text){o.s=i[1];t.callbacks.normal_text(e,o,t.context)}else e.s+=i[1]}else if(i.length==1){e.s+=i[0]}return 2}function pt(e,t,n,i){var s=n.slice(i);var o=1;var u=new vn;if(o<s.length&&s[o]=="#")o++;while(o<s.length&&r(s[o]))o++;if(o<s.length&&s[o]==";")o++;else return 0;if(t.callbacks.entity){u.s=s.slice(0,o);t.callbacks.entity(e,u,t.context)}else e.s+=s.slice(0,o);return o}function dt(e,t,n,r){var i=n.slice(r);var s=null;var o,u={p:null};if(!t.callbacks.autolink||t.inLinkBody)return 0;s=new vn;t.spanStack.push(s);if((o=b(u,s,n,r,i.length,0))>0){if(u.p>0)e.s=e.s.slice(0,-u.p);t.callbacks.autolink(e,s,It,t.context)}t.spanStack.pop();return o}function vt(e,t,n,r){var i=n.slice(r);var s=null;var o,u={p:null};if(!t.callbacks.autolink||t.inLinkBody)return 0;s=new vn;t.spanStack.push(s);if((o=S(u,s,n,r,i.length,0))>0){if(u.p>0)e.s=e.s.slice(0,-u.p);t.callbacks.autolink(e,s,qt,t.context)}t.spanStack.pop();return o}function mt(e,t,n,r){var i=n.slice(r);var s=null,o=null,u=null;var a,f={p:null};if(!t.callbacks.link||t.inLinkBody)return 0;s=new vn;t.spanStack.push(s);if((a=x(f,s,n,r,i.length,0))>0){o=new vn;t.spanStack.push(o);o.s+="http://";o.s+=s.s;if(f.p>0)e.s=e.s.slice(0,e.s.length-f.p);if(t.callbacks.normal_text){u=new vn;t.spanStack.push(u);t.callbacks.normal_text(u,s,t.context);t.callbacks.link(e,o,null,u,t.context);t.spanStack.pop()}else{t.callbacks.link(e,o,null,s,t.context)}t.spanStack.pop()}t.spanStack.pop();return a}function gt(e,t,n,r){var i=n.slice(r);var s=null;var o,u={p:null};if(!t.callbacks.autolink||t.inLinkBody)return 0;s=new vn;t.spanStack.push(s);if((o=w(u,s,n,r,i.length))>0){if(u.p>0)e.s=e.s.slice(0,-u.p);t.callbacks.autolink(e,s,It,t.context)}else if((o=E(u,s,n,r,i.length))>0){if(u.p>0)e.s=e.s.slice(0,-u.p);t.callbacks.autolink(e,s,It,t.context)}t.spanStack.pop();return o}function yt(e,n,r,i){var s=r.slice(i);var o=s.length;var u,a;var f=null;if(!n.callbacks.superscript)return 0;if(o<2)return 0;if(s[1]=="("){u=a=2;while(a<o&&s[a]!=")"&&s[a-1]!="\\")a++;if(a==o)return 0}else{u=a=1;while(a<o&&!t(s[a]))a++}if(a-u==0)return u==2?3:0;f=new vn;n.spanStack.push(f);Pn(f,n,s.slice(u,a));n.callbacks.superscript(e,f,n.context);n.spanStack.pop();return u==2?a+1:a}function vn(e){this.s=e||""}function mn(){this.spanStack=[];this.blockStack=[];this.extensions=Rt|$t|Wt|Xt|Ut;var e=L();this.context=e.context;this.callbacks=e.callbacks;this.inLinkBody=0;this.activeChars={};this.refs={};this.nestingLimit=16}function gn(e){var t;for(t=0;t<e.length&&e[t]!="\n";t++)if(e[t]!=" ")return 0;return t+1}function yn(e){var t=0,n=0;var r;if(e.length<3)return 0;if(e[0]==" "){t++;if(e[1]==" "){t++;if(e[2]==" "){t++}}}if(t+2>=e.length||e[t]!="*"&&e[t]!="-"&&e[t]!="_")return 0;r=e[t];while(t<e.length&&e[t]!="\n"){if(e[t]==r)n++;else if(e[t]!=" ")return 0;t++}return n>=3}function bn(e){var t=0,n=0;var r;if(e.length<3)return 0;if(e[0]==" "){t++;if(e[1]==" "){t++;if(e[2]==" "){t++}}}if(t+2>=e.length||!(e[t]=="~"||e[t]=="`"))return 0;r=e[t];while(t<e.length&&e[t]==r){n++;t++}if(n<3)return 0;return t}function wn(e,n){var r=0,i=0;r=bn(e);if(r==0)return 0;while(r<e.length&&e[r]==" ")r++;var s;s=r;if(r<e.length&&e[r]=="{"){r++;s++;while(r<e.length&&e[r]!="}"&&e[r]!="\n"){i++;r++}if(r==e.length||e[r]!="}")return 0;while(i>0&&t(e[s+0])){s++;i--}while(i>0&&t(e[s+i-1]))i--;r++}else{while(r<e.length&&!t(e[r])){i++;r++}}if(n)n.s=e.substr(s,i);while(r<e.length&&e[r]!="\n"){if(!t(e[r]))return 0;r++}return r+1}function En(e,t){var n=1;while(n<e.length){while(n<e.length&&e[n]!=t&&e[n]!="`"&&e[n]!="[")n++;if(n==e.length)return 0;if(e[n]==t)return n;if(n&&e[n-1]=="\\"){n++;continue}if(e[n]=="`"){var r=0,i;var s=0;while(n<e.length&&e[n]=="`"){n++;r++}if(n>=e.length)return 0;i=0;while(n<e.length&&i<r){if(!s&&e[n]==t)s=n;if(e[n]=="`")i++;else i=0;n++}if(n>=e.length)return s}else if(e[n]=="["){var s=0;var o;n++;while(n<e.length&&e[n]!="]"){if(!s&&e[n]==t)s=n;n++}n++;while(n<e.length&&(e[n]==" "||e[n]=="\n"))n++;if(n>=e.length)return s;switch(e[n]){case"[":o="]";break;case"(":o=")";break;default:if(s)return s;else continue}n++;while(n<e.length&&e[n]!=o){if(!s&&e[n]==t)s=n;n++}if(n>=e.length)return s;n++}}return 0}function Sn(e,n,r,i){var o=r.slice(1);var u=0,a;var f;if(!n.callbacks.emphasis)return 0;if(o.length>1&&o[0]==i&&o[1]==i)u=1;while(u<o.length){a=En(o.slice(u),i);if(!a)return 0;u+=a;if(u>=o.length)return 0;if(o[u]==i&&!t(o[u-1])){if(n.extensions&Rt&&i=="_"){if(!(u+1==o.length||t(o[u+1])||s(o[u+1])))continue}var l=new vn;n.spanStack.push(l);Pn(l,n,o.slice(0,u));f=n.callbacks.emphasis(e,l,n.context);n.spanStack.pop();return f?u+1:0}}return 0}function xn(e,n,r,i){var s=r.slice(2);var o=0,u;var a;var f=i=="~"?n.callbacks.strikethrough:n.callbacks.double_emphasis;if(!f)return 0;while(o<s.length){u=En(s.slice(o),i);if(!u)return 0;o+=u;if(o+1<s.length&&s[o]==i&&s[o+1]==i&&o&&!t(s[o-1])){var l=new vn;n.spanStack.push(l);Pn(l,n,s.slice(0,o));a=f(e,l,n.context);n.spanStack.pop();return a?o+2:0}o++}return 0}function Tn(e,n,r,i){var s=r.slice(3);var o=0,u;var a;while(o<s.length){u=En(s.slice(o),i);if(!u)return 0;o+=u;if(s[o]!=i||t(s[o-1]))continue;if(o+2<s.length&&s[o+1]==i&&s[o+2]==i&&n.callbacks.triple_emphasis){var f=new vn;n.spanStack.push(f);Pn(f,n,s.slice(0,o));a=n.callbacks.triple_emphasis(e,f,n.context);n.spanStack.pop();return a?o+3:0}else if(o+1<s.length&&s[o+1]==i){u=Sn(e,n,r,i);if(!u)return 0;else return u-2}else{u=xn(e,n,r,i);if(!u)return 0;else return u-1}}return 0}function Nn(e,t){if(t[0]!="#")return false;if(e.extensions&Vt){var n=0;while(n<t.length&&n<6&&t[n]=="#")n++;if(n<t.length&&t[n]!=" ")return false}return true}function Cn(e){var t=0;var n=e.length;if(e[t]=="="){for(t=1;t<n&&e[t]=="=";t++){}while(t<n&&e[t]==" ")t++;return t>=n||e[t]=="\n"?1:0}if(e[t]=="-"){for(t=1;t<n&&e[t]=="-";t++){}while(t<n&&e[t]==" ")t++;return t>=n||e[t]=="\n"?2:0}return 0}function kn(e){var t=e.length;var n=0;while(n<t&&e[n]!="\n")n++;if(++n>=t)return 0;return Cn(e.slice(n))}function Ln(e){var t=0;var n=e.length;if(t<n&&e[t]==" ")t++;if(t<n&&e[t]==" ")t++;if(t<n&&e[t]==" ")t++;if(t<n&&e[t]==">"){if(t+1<n&&e[t+1]==" ")return t+2;return t+1}return 0}function An(e){if(e.length>3&&e[0]==" "&&e[1]==" "&&e[2]==" "&&e[3]==" ")return 4;return 0}function On(e){var t=e.length;var n=0;if(n<t&&e[n]==" ")n++;if(n<t&&e[n]==" ")n++;if(n<t&&e[n]==" ")n++;if(n>=t||e[n]<"0"||e[n]>"9")return 0;while(n<t&&e[n]>="0"&&e[n]<="9")n++;if(n+1>=t||e[n]!="."||e[n+1]!=" ")return 0;if(kn(e.slice(n)))return 0;return n+2}function Mn(e){var t=e.length;var n=0;if(n<t&&e[n]==" ")n++;if(n<t&&e[n]==" ")n++;if(n<t&&e[n]==" ")n++;if(n+1>=t||e[n]!="*"&&e[n]!="+"&&e[n]!="-"||e[n+1]!=" ")return 0;if(kn(e.slice(n)))return 0;return n+2}function _n(e){var t=0,n=0;for(t=0;t<e.length;++t){if(r(e[t]))continue;switch(e[t]){case"@":n++;case"-":case".":case"_":break;case">":return n==1?t+1:0;default:return 0}}return 0}function Dn(e,t){var n,i;if(e.length<3)return 0;if(e[0]!="<")return 0;n=e[1]=="/"?2:1;if(!r(e[n]))return 0;t.p=Ft;while(n<e.length&&(r(e[n])||e[n]=="."||e[n]=="+"||e[n]=="-"))n++;if(n>1&&e[n]=="@"){if((i=_n(e.slice(n)))!=0){t.p=qt;return n+i}}if(n>2&&e[n]==":"){t.p=It;n++}if(n>=e.length)t.p=Ft;else if(t.p){i=n;while(n<e.length){if(e[n]=="\\")n+=2;else if(e[n]==">"||e[n]=="'"||e[n]=='"'||e[n]==" "||e[n]=="\n")break;else n++}if(n>=e.length)return 0;if(n>i&&e[n]==">")return n+1;t.p=Ft}while(n<e.length&&e[n]!=">")n++;if(n>=e.length)return 0;return n+1}function Pn(e,t,n){var r=0,i=0;var s=0;var o=new vn;if(t.spanStack.length+t.blockStack.length>t.nestingLimit)return;while(r<n.length){while(i<n.length&&!(s=t.activeChars[n[i]])){i++}if(t.callbacks.normal_text){o.s=n.slice(r,i);t.callbacks.normal_text(e,o,t.context)}else e.s+=n.slice(r,i);if(i>=n.length)break;r=i;i=bt[s](e,t,n,r);if(!i)i=r+1;else{r+=i;i=r}}}function Hn(e,t,n){var r=0;var i,s,o;while(r<n.length&&r<6&&n[r]=="#")r++;for(i=r;i<n.length&&n[i]==" ";i++){}for(s=i;s<n.length&&n[s]!="\n";s++){}o=s;while(s&&n[s-1]=="#")s--;while(s&&n[s-1]==" ")s--;if(s>i){var u=new vn;t.spanStack.push(u);Pn(u,t,n.slice(i,s));if(t.callbacks.header)t.callbacks.header(e,u,r,t.context);t.spanStack.pop()}return o}function Bn(e,t,n){var r,i;if(e.length+3>=n.length||n.slice(2).toLowerCase()!=e||n[e.length+2]!=">")return 0;r=e.length+3;i=0;if(r<n.length&&(i=gn(n.slice(r)))==0)return 0;r+=i;i=0;if(r<n.length)i=gn(n.slice(r));return r+i}function jn(e,t,n,r){var i,s=0;var o=null;var u;var f=new vn(n);if(n.length<2||n[0]!="<")return 0;i=1;while(i<n.length&&n[i]!=">"&&n[i]!=" ")i++;if(i<n.length)o=a(n.slice(1));if(!o){if(n.length>5&&n[1]=="!"&&n[2]=="-"&&n[3]=="-"){i=5;while(i<n.length&&!(n[i-2]=="-"&&n[i-1]=="-"&&n[i]==">"))i++;i++;if(i<size)s=gn(n.slice(i));if(s){f.s=n.slice(0,i+s);if(r&&t.callbacks.blockhtml)t.callbacks.blockhtml(e,f,t.context);return f.s.length}}if(n.length>4&&(n[1]=="h"||n[1]=="H")&&(n[2]=="r"||n[2]=="R")){i=3;while(i<n.length&&n[i]!=">")i++;if(i+1<n.length){i++;s=gn(n.slice(i));if(s){f.s=n.slice(0,i+s);if(r&&t.callbacks.blockhtml)t.callbacks.blockhtml(e,f,t.context);return f.s.length}}}return 0}i=1;u=0;if(o!="ins"&&o!="del"){var l=o.length;i=1;while(i<n.length){i++;while(i<n.length&&!(n[i-1]=="<"&&n[i]=="/"))i++;if(i+2+l>=n.length)break;s=Bn(tag,t,n.slice(i-1));if(s){i+=s-1;u=1;break}}}if(!u)return 0;f.s=f.s.slice(0,i);if(r&&t.callbacks.blockhtml)t.callbacks.blockhtml(e,f,t.context);return i}function Fn(e,t,n){var r=n.length;var i,s=0,o,u=0;var a="";var f=0;var l=new vn;t.blockStack.push(l);i=0;while(i<r){for(s=i+1;s<r&&n[s-1]!="\n";s++){}o=Ln(n.slice(i,s));if(o)i+=o;else if(gn(n.slice(i,s))&&(s>=r||Ln(n.slice(s))==0&&!gn(n.slice(s))))break;if(i<s){a+=n.slice(i,s);u+=s-i}i=s}$n(l,t,a);if(t.callbacks.blockquote)t.callbacks.blockquote(e,l,t.context);t.blockStack.pop();return s}function In(e,t,n){var i=0,s=0;var o=0;var u=n.length;var a=new vn(n);while(i<u){for(s=i+1;s<u&&n[s-1]!="\n";s++){}if(Ln(n.slice(i,s))!=0){s=i;break}var f=n.slice(i);if(gn(f)||(o=Cn(f))!=0)break;if(gn(f))break;if((o=Cn(f))!=0)break;if(Nn(t,f)||yn(f)||Ln(f)){s=i;break}if(t.extensions&Jt&&!r(n[i])){if(On(f)||Mn(f)){s=i;break}if(n[i]=="<"&&t.callbacks.blockhtml&&jn(e,t,f,0)){s=i;break}if((t.extensions&&zt)!=0&&wn(f,null)!=0){s=i;break}}i=s}var l=i;while(l&&n[l-1]=="\n")l--;a.s=a.s.slice(0,l);if(!o){var c=new vn;t.blockStack.push(c);Pn(c,t,a.s);if(t.callbacks.paragraph)t.callbacks.paragraph(e,c,t.context);t.blockStack.pop()}else{var h=null;if(a.size){var p;i=a.s.length;while(l&&n[l]!="\n")l-=1;p=l+1;while(l&&n[l-1]=="\n")l-=1;a.s=a.s.slice(0,l);if(l>0){var c=new vn;t.blockStack.push(c);Pn(c,t,a.s);if(t.callbacks.paragraph)t.callbacks.paragraph(e,c,t.context);t.blockStack.pop();a.s=a.s.slice(p,i)}else a.s=a.s.slice(0,i)}h=new vn;t.spanStack.push(h);Pn(h,t,a.s);if(t.callbacks.header)t.callbacks.header(e,h,o,t.context);t.spanStack.pop()}return s}function qn(e,t,n){var r,i;var s=null;var o=new vn;r=wn(n,o);if(r==0)return 0;s=new vn;t.blockStack.push(s);while(r<n.length){var u;var a=new vn;u=wn(n.slice(r),a);if(u!=0&&a.s.length==0){r+=u;break}for(i=r+1;i<n.length&&n[i-1]!="\n";i++){}if(r<i){var f=n.slice(r,i);if(gn(f))s.s+="\n";else s.s+=f}r=i}if(s.s.length&&s.s[s.s.length-1]!="\n")s.s+="\n";if(t.callbacks.blockcode)t.callbacks.blockcode(e,s,o.s.length?o:null,t.context);t.blockStack.pop();return r}function Rn(e,t,n){var r=n.length;var i,s,o;var u=null;t.blockStack.push(u=new vn);i=0;while(i<r){for(s=i+1;s<r&&n[s-1]!="\n";s++){}o=An(n.slice(i,s));if(o)i+=o;else if(!gn(n.slice(i,s)))break;if(i<s){if(gn(n.slice(i,s)))u.s+="\n";else u.s+=n.slice(i,s)}i=s}var a=u.s.length;while(a&&u.s[a-1]=="\n")a-=1;u.s=u.s.slice(0,a);u.s+="\n";if(t.callbacks.blockcode)t.callbacks.blockcode(e,u,null,t.context);t.blockStack.pop();return i}function Un(e,t,n,r){var i=n.length;var s=null,o=null;var u=0,a,f,l=0,c=0,h;var p=0,d=0,v=0;while(c<3&&c<i&&n[c]==" ")c++;u=Mn(n);if(!u)u=On(n);if(!u)return 0;a=u;while(a<i&&n[a-1]!="\n")a++;t.spanStack.push(s=new vn);t.spanStack.push(o=new vn);s.s+=n.slice(u,a);u=a;while(u<i){var m,g;a++;while(a<i&&n[a-1]!="\n")a++;if(gn(n.slice(u,a))){p=1;u=a;continue}h=0;while(h<4&&u+h<a&&n[u+h]==" ")h++;f=h;if(t.flags&zt){if(wn(n.slice(u+h,a),null)!=0){v=!v}}if(!v){m=Mn(n.slice(u+h,a));g=On(n.slice(u+h,a))}if(p&&(r.p&wt&&m||!(r.p&wt)&&g)){r.p|=St;break}if(m&&!yn(n.slice(u+h,a))||g){if(p)d=1;if(f==c)break;if(!l)l=s.s.length}else if(p&&f==0){r.p|=St;break}else if(p){s.s+="\n";d=1}p=0;s.s+=n.slice(u+h,a);u=a}if(d)r.p|=Et;if(r.p&Et){if(l&&l<s.s.length){$n(o,t,s.s.slice(0,l));$n(o,t,s.s.slice(l))}else $n(o,t,s.s)}else{if(l&&l<s.s.length){Pn(o,t,s.s.slice(0,l));$n(o,t,s.s.slice(l))}else Pn(o,t,s.s)}if(t.callbacks.listitem)t.callbacks.listitem(e,o,r.p,t.context);t.spanStack.pop();t.spanStack.pop();return u}function zn(e,t,n,r){var i=n.length;var s=0,o;var u=null;t.blockStack.push(u=new vn);while(s<i){var a={p:r};o=Un(u,t,n.slice(s),a);r=a.p;s+=o;if(!o||r&St)break}if(t.callbacks.list)t.callbacks.list(e,u,r,t.context);t.blockStack.pop();return s}function Wn(e,n,r,i,s){var o=0,u;var a=null;if(!n.callbacks.table_cell||!n.callbacks.table_row)return;n.spanStack.push(a=new vn);if(o<r.length&&r[o]=="|")o++;for(u=0;u<i.length&&o<r.length;++u){var f,l;var c;n.spanStack.push(c=new vn);while(o<r.length&&t(r[o]))o++;f=o;while(o<r.length&&r[o]!="|")o++;l=o-1;while(l>f&&t(r[l]))l--;Pn(c,n,r.slice(f,1+l));n.callbacks.table_cell(a,c,i[u]|s,n.context);n.spanStack.pop();o++}for(;u<i.length;++u){var h=null;n.callbacks.table_cell(a,h,i[u]|s,n.context)}n.callbacks.table_row(e,a,n.context);n.spanStack.pop()}function Xn(e,n,r,i){var s=0,o,u,a;var f=0;while(s<r.length&&r[s]!="\n")if(r[s++]=="|")f++;if(s==r.length||f==0)return 0;u=s;while(u>0&&t(r[u-1]))u--;if(r[0]=="|")f--;if(u&&r[u-1]=="|")f--;i.p=new Array(f+1);for(var l=0;l<i.p.length;l++)i.p[l]=0;s++;if(s<r.length&&r[s]=="|")s++;a=s;while(a<r.length&&r[a]!="\n")a++;for(o=0;o<i.p.length&&s<a;++o){var c=0;while(s<a&&r[s]==" ")s++;if(r[s]==":"){s++;i.p[o]|=un;c++}while(s<a&&r[s]=="-"){s++;c++}if(s<a&&r[s]==":"){s++;i.p[o]|=an;c++}while(s<a&&r[s]==" ")s++;if(s<a&&r[s]!="|")break;if(c<1)break;s++}if(o<i.p.length)return 0;Wn(e,n,r.slice(0,u),i.p,cn);return a+1}function Vn(e,t,n){var r;var i,s;var o={p:null};t.spanStack.push(i=new vn);t.blockStack.push(s=new vn);r=Xn(i,t,n,o);if(r>0){while(r<n.length){var u;var a=0;u=r;while(r<n.length&&n[r]!="\n")if(n[r++]=="|")a++;if(a==0||r==n.length){r=u;break}Wn(s,t,n.slice(u,r),o.p,0);r++}if(t.callbacks.table)t.callbacks.table(e,i,s,t.context)}t.spanStack.pop();t.blockStack.pop();return r}function $n(e,t,n){var r=0,i,s;var o;if(t.spanStack.length+t.blockStack.length>t.nestingLimit)return;while(r<n.length){o=n.slice(r);i=n.length-r;if(Nn(t,o))r+=Hn(e,t,o);else if(n[r]=="<"&&t.callbacks.blockhtml&&(s=jn(e,t,o,1))!=0)r+=s;else if((s=gn(o))!=0)r+=s;else if(yn(o)){if(t.callbacks.hrule)t.callbacks.hrule(e,t.context);while(r<n.length&&n[r]!="\n")r++;r++}else if((t.extensions&zt)!=0&&(s=qn(e,t,o))!=0)r+=s;else if((t.extensions&Ut)!=0&&(s=Vn(e,t,o))!=0)r+=s;else if(Ln(o))r+=Fn(e,t,o);else if(An(o))r+=Rn(e,t,o);else if(Mn(o))r+=zn(e,t,o,0);else if(On(o))r+=zn(e,t,o,wt);else{r+=In(e,t,o)}}}function Jn(e,t,n,r){var i=0;var s,o;var u,a;var f,l;var c;if(t+3>=n)return 0;if(e[t]==" "){i=1;if(e[t+1]==" "){i=2;if(e[t+2]==" "){i=3;if(e[t+3]==" ")return 0}}}i+=t;if(e[i]!="[")return 0;i++;s=i;while(i<n&&e[i]!="\n"&&e[i]!="\r"&&e[i]!="]")i++;if(i>=n||e[i]!="]")return 0;o=i;i++;if(i>=n||e[i]!=":")return 0;i++;while(i<n&&e[i]==" ")i++;if(i<n&&(e[i]=="\n"||e[i]=="\r")){i++;if(i<n&&e[i]=="\r"&&e[i-1]=="\n")i++}while(i<n&&e[i]==" ")i++;if(i>=n)return 0;if(e[i]=="<")i++;u=i;while(i<n&&e[i]!=" "&&e[i]!="\n"&&e[i]!="\r")i++;if(e[i-1]==">")a=i-1;else a=i;while(i<n&&e[i]==" ")i++;if(i<n&&e[i]!="\n"&&e[i]!="\r"&&e[i]!="'"&&e[i]!='"'&&e[i]!="(")return 0;c=0;if(i>=n||e[i]=="\r"||e[i]=="\n")c=i;if(i+1<n&&e[i]=="\n"&&e[i+1]=="\r")c=i+1;if(c){i=c+1;while(i<n&&e[i]==" ")i++}f=l=0;if(i+1<n&&(e[i]=="'"||e[i]=='"'||e[i]=="(")){i++;f=i;while(i<n&&e[i]!="\n"&&e[i]!="\r")i++;if(i+1<n&&e[i]=="\n"&&e[i+1]=="\r")l=i+1;else l=i;i-=1;while(i>f&&e[i]==" ")i-=1;if(i>f&&(e[i]=="'"||e[i]=='"'||e[i]==")")){c=l;l=i}}if(!c||a==u)return 0;var h=e.slice(s,o);var p=e.slice(u,a);var d=null;if(l>f)d=e.slice(f,l);r.refs[h]={id:h,link:new vn(p),title:new vn(d)};return c}function Kn(e,t){var n=0,r=0;while(n<t.length){var i=n;while(n<t.length&&t[n]!="	"){n++;r++}if(n>i)e.s+=t.slice(i,n);if(n>=t.length)break;do{e.s+=" ";r++}while(r%4);n++}}function Qn(e){var t=new vn;var n=0,r;this.refs={};while(n<e.length){if(r=Jn(e,n,e.length,this))n=r;else{r=n;while(r<e.length&&e[r]!="\n"&&e[r]!="\r")r++;if(r>n)Kn(t,e.slice(n,r));while(r<e.length&&(e[r]=="\n"||e[r]=="\r")){if(e[r]=="\n"||r+1<e.length&&e[r+1]!="\n")t.s+="\n";r++}n=r}}var i=new vn;if(this.callbacks.doc_header)this.callbacks.doc_header(i,this.context);if(t.s.length){if(t.s[t.s.length-1]!="\n"&&t.s[t.s.length-1]!="\r")t.s+="\n";$n(i,this,t.s)}if(this.callbacks.doc_footer)this.callbacks.doc_footer(i,this.context);return i.s}var c=[7,7,7,7,7,7,7,7,7,0,0,7,7,0,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,0,0,1,0,0,0,2,3,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,5,0,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];var h=["","&quot;","&","&#39;","&#47;","&lt;","&gt;",""];var d=[2,2,2,2,2,2,2,2,2,0,0,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,1,0,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];T.prototype={blockcode:null,blockquote:null,blockhtml:null,header:null,hrule:null,list:null,listitem:null,paragraph:null,table:null,table_row:null,table_cell:null,autolink:null,codespan:null,double_emphasis:null,emphasis:null,image:null,linebreak:null,link:null,raw_html_tag:null,triple_emphasis:null,strikethrough:null,superscript:null,entity:null,normal_text:null,doc_header:null,doc_footer:null};e.createCustomRenderer=C;e.defaultRenderState=k;e.getRedditRenderer=L;e.getTocRenderer=A;e.createCustomCallbacks=O;e.getRedditCallbacks=M;e.getTocCallbacks=_;var bt=[null,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt];var wt=1;var Et=2;var St=8;var xt=0;var Tt=xt++;var Nt=xt++;var Ct=xt++;var kt=xt++;var Lt=xt++;var At=xt++;var Ot=xt++;var Mt=xt++;var _t=xt++;var Dt=xt++;var Pt=xt++;var Ht=xt++;var Bt=xt++;var jt=1<<0;xt=0;var Ft=xt++;var It=xt++;var qt=xt++;var Rt=1<<0;var Ut=1<<1;var zt=1<<2;var Wt=1<<3;var Xt=1<<4;var Vt=1<<6;var $t=1<<7;var Jt=1<<8;var Kt=1<<0;var Qt=1<<1;var Gt=1<<2;var Yt=1<<3;var Zt=1<<4;var en=1<<5;var tn=1<<6;var nn=1<<7;var rn=1<<8;var sn=1<<9;var on=1<<10;var un=1;var an=2;var fn=3;var ln=3;var cn=4;var hn=0;var pn=1;var dn=2;mn.prototype["render"]=Qn;e.getParser=function(t,n,r){var i=new mn;if(t)i.callbacks=t.callbacks;if(r)i.nestingLimit=r;if(t)i.context=t.context;if(n!=undefined&&n!=null)i.extensions=n;var s=i.callbacks;if(s.emphasis||s.double_emphasis||s.triple_emphasis){i.activeChars["*"]=Nt;i.activeChars["_"]=Nt;if(i.extensions&Xt)i.activeChars["~"]=Nt}if(s.codespan)i.activeChars["`"]=Ct;if(s.linebreak)i.activeChars["\n"]=kt;if(s.image||s.link)i.activeChars["["]=Lt;i.activeChars["<"]=At;i.activeChars["\\"]=Ot;i.activeChars["&"]=Mt;if(i.extensions&Wt){i.activeChars[":"]=_t;i.activeChars["@"]=Dt;i.activeChars["w"]=Pt;i.activeChars["/"]=Ht}if(i.extensions&$t)i.activeChars["^"]=Bt;return i};var Gn=Kt|Gt|en|sn|rn;var Yn=Kt|en|on|sn|rn;var Zn=["colspan","rowspan","cellspacing","cellpadding","scope"];var er=["tr","th","td","table","tbody","thead","tfoot","caption"];e.DEFAULT_HTML_ELEMENT_WHITELIST=er;e.DEFAULT_HTML_ATTR_WHITELIST=Zn;e.DEFAULT_BODY_FLAGS=Gn;e.DEFAULT_WIKI_FLAGS=Yn;e.HTML_SKIP_HTML=Kt;e.HTML_SKIP_STYLE=Qt;e.HTML_SKIP_IMAGES=Gt;e.HTML_SKIP_LINKS=Yt;e.HTML_EXPAND_TABS=Zt;e.HTML_SAFELINK=en;e.HTML_TOC=tn;e.HTML_HARD_WRAP=nn;e.HTML_USE_XHTML=rn;e.HTML_ESCAPE=sn;e.HTML_ALLOW_ELEMENT_WHITELIST=on;e.MKDEXT_NO_INTRA_EMPHASIS=Rt;e.MKDEXT_TABLES=Ut;e.MKDEXT_FENCED_CODE=zt;e.MKDEXT_AUTOLINK=Wt;e.MKDEXT_STRIKETHROUGH=Xt;e.MKDEXT_SPACE_HEADERS=Vt;e.MKDEXT_SUPERSCRIPT=$t;e.MKDEXT_LAX_SPACING=Jt;e["SD_AUTOLINK_SHORT_DOMAINS"]=jt;e.MKDA_NOT_AUTOLINK=Ft;e.MKDA_NORMAL=It;e.MKDA_EMAIL=qt;if(typeof define==="function"){define("snuownd",[],e)}})(typeof exports!=="undefined"?exports:typeof window!=="undefined"?window.SnuOwnd={}:{})